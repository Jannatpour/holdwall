/**
 * Internationalization (i18n) Configuration
 * Multi-language support with locale detection and translation
 */

export type Locale = "en" | "es" | "fr" | "de" | "ja" | "zh";

export const defaultLocale: Locale = "en";
export const supportedLocales: Locale[] = ["en", "es", "fr", "de", "ja", "zh"];

export interface Translations {
  [key: string]: string | Translations;
}

export const translations: Record<Locale, Translations> = {
  en: {
    common: {
      save: "Save",
      cancel: "Cancel",
      delete: "Delete",
      edit: "Edit",
      create: "Create",
      search: "Search",
      loading: "Loading...",
      error: "Error",
      success: "Success",
    },
    nav: {
      overview: "Overview",
      signals: "Signals",
      claims: "Claims",
      graph: "Belief Graph",
      forecasts: "Forecasts",
      studio: "AAAL Studio",
      governance: "Governance",
    },
    claims: {
      title: "Claims",
      create: "Create Claim",
      decisiveness: "Decisiveness",
      evidence: "Evidence",
      cluster: "Cluster",
    },
    evidence: {
      title: "Evidence",
      type: "Type",
      source: "Source",
      content: "Content",
    },
    cases: {
      title: "Report an Issue",
      description: "Submit a case for resolution. Our autonomous system will triage and route your case appropriately.",
      type: "Issue Type",
      typeRequired: "Issue Type is required",
      descriptionLabel: "Description",
      descriptionRequired: "Description is required",
      descriptionMinLength: "Description must be at least 10 characters",
      impact: "Impact",
      preferredResolution: "Preferred Resolution",
      submittedBy: "Your Email or Name",
      submittedByRequired: "Your email or name is required",
      submittedByEmail: "Email Address",
      submittedByName: "Full Name",
      consent: "I agree to the privacy notice and consent to processing my case",
      consentRequired: "You must accept the privacy notice",
      submit: "Submit Case",
      submitting: "Submitting...",
      success: "Case Submitted Successfully",
      caseNumber: "Your case number is",
      trackCase: "Track Your Case",
      error: "Failed to submit case",
      fileUpload: "Upload Files",
      fileUploadDescription: "Upload supporting documents (PDF, PNG, JPG, CSV, max 10MB each)",
      privacyNotice: "Privacy Notice",
      trackTitle: "Track Your Case",
      trackDescription: "Enter your case number and email to view your case status and updates.",
      caseNumberLabel: "Case Number",
      emailLabel: "Email Address",
      lookup: "Track Case",
      verifying: "Verifying...",
      verificationCode: "Verification Code",
      verificationSent: "We've sent a verification code to your email. Please enter it below.",
      verify: "Verify",
      back: "Back",
      caseDetails: "Case Details",
      overview: "Overview",
      resolution: "Resolution Plan",
      evidence: "Evidence",
      timeline: "Timeline",
      status: "Status",
      severity: "Severity",
      lastUpdated: "Last Updated",
      created: "Created",
      resolutionPlan: "Your Resolution Plan",
      safetySteps: "Safety Steps",
      viewArtifact: "View Resolution Artifact",
      noResolution: "Resolution plan is being prepared. Check back soon.",
      noEvidence: "No evidence files attached to this case.",
      noTimeline: "Timeline view coming soon.",
      trackAnother: "Track Another Case",
    },
  },
  es: {
    common: {
      save: "Guardar",
      cancel: "Cancelar",
      delete: "Eliminar",
      edit: "Editar",
      create: "Crear",
      search: "Buscar",
      loading: "Cargando...",
      error: "Error",
      success: "Éxito",
    },
    nav: {
      overview: "Resumen",
      signals: "Señales",
      claims: "Afirmaciones",
      graph: "Gráfico de Creencias",
      forecasts: "Pronósticos",
      studio: "Estudio AAAL",
      governance: "Gobernanza",
    },
    claims: {
      title: "Afirmaciones",
      create: "Crear Afirmación",
      decisiveness: "Decisividad",
      evidence: "Evidencia",
      cluster: "Agrupación",
    },
    evidence: {
      title: "Evidencia",
      type: "Tipo",
      source: "Fuente",
      content: "Contenido",
    },
    cases: {
      title: "Reportar un Problema",
      description: "Envíe un caso para su resolución. Nuestro sistema autónomo clasificará y dirigirá su caso adecuadamente.",
      type: "Tipo de Problema",
      typeRequired: "El tipo de problema es requerido",
      descriptionLabel: "Descripción",
      descriptionRequired: "La descripción es requerida",
      descriptionMinLength: "La descripción debe tener al menos 10 caracteres",
      impact: "Impacto",
      preferredResolution: "Resolución Preferida",
      submittedBy: "Su Correo Electrónico o Nombre",
      submittedByRequired: "Su correo electrónico o nombre es requerido",
      submittedByEmail: "Dirección de Correo Electrónico",
      submittedByName: "Nombre Completo",
      consent: "Acepto el aviso de privacidad y consiento el procesamiento de mi caso",
      consentRequired: "Debe aceptar el aviso de privacidad",
      submit: "Enviar Caso",
      submitting: "Enviando...",
      success: "Caso Enviado Exitosamente",
      caseNumber: "Su número de caso es",
      trackCase: "Rastrear Su Caso",
      error: "Error al enviar el caso",
      fileUpload: "Subir Archivos",
      fileUploadDescription: "Subir documentos de apoyo (PDF, PNG, JPG, CSV, máximo 10MB cada uno)",
      privacyNotice: "Aviso de Privacidad",
      trackTitle: "Rastrear Su Caso",
      trackDescription: "Ingrese su número de caso y correo electrónico para ver el estado y las actualizaciones de su caso.",
      caseNumberLabel: "Número de Caso",
      emailLabel: "Dirección de Correo Electrónico",
      lookup: "Rastrear Caso",
      verifying: "Verificando...",
      verificationCode: "Código de Verificación",
      verificationSent: "Hemos enviado un código de verificación a su correo electrónico. Por favor ingréselo a continuación.",
      verify: "Verificar",
      back: "Atrás",
      caseDetails: "Detalles del Caso",
      overview: "Resumen",
      resolution: "Plan de Resolución",
      evidence: "Evidencia",
      timeline: "Cronología",
      status: "Estado",
      severity: "Severidad",
      lastUpdated: "Última Actualización",
      created: "Creado",
      resolutionPlan: "Su Plan de Resolución",
      safetySteps: "Pasos de Seguridad",
      viewArtifact: "Ver Artefacto de Resolución",
      noResolution: "El plan de resolución se está preparando. Vuelva pronto.",
      noEvidence: "No hay archivos de evidencia adjuntos a este caso.",
      noTimeline: "La vista de cronología estará disponible pronto.",
      trackAnother: "Rastrear Otro Caso",
      dispute: "Disputa de Pago / Contracargo",
      fraud: "Fraude / Toma de Cuenta",
      outage: "Retraso en Transacción / Interrupción",
      complaint: "Queja / Otro",
    },
  },
  fr: {
    common: {
      save: "Enregistrer",
      cancel: "Annuler",
      delete: "Supprimer",
      edit: "Modifier",
      create: "Créer",
      search: "Rechercher",
      loading: "Chargement...",
      error: "Erreur",
      success: "Succès",
    },
    nav: {
      overview: "Vue d'ensemble",
      signals: "Signaux",
      claims: "Revendications",
      graph: "Graphe de Croyances",
      forecasts: "Prévisions",
      studio: "Studio AAAL",
      governance: "Gouvernance",
    },
    claims: {
      title: "Revendications",
      create: "Créer une Revendication",
      decisiveness: "Détermination",
      evidence: "Preuve",
      cluster: "Groupe",
    },
    evidence: {
      title: "Preuve",
      type: "Type",
      source: "Source",
      content: "Contenu",
    },
    cases: {
      title: "Signaler un Problème",
      description: "Soumettez un cas pour résolution. Notre système autonome classera et routera votre cas de manière appropriée.",
      type: "Type de Problème",
      typeRequired: "Le type de problème est requis",
      descriptionLabel: "Description",
      descriptionRequired: "La description est requise",
      descriptionMinLength: "La description doit contenir au moins 10 caractères",
      impact: "Impact",
      preferredResolution: "Résolution Préférée",
      submittedBy: "Votre Email ou Nom",
      submittedByRequired: "Votre email ou nom est requis",
      submittedByEmail: "Adresse Email",
      submittedByName: "Nom Complet",
      consent: "J'accepte l'avis de confidentialité et consens au traitement de mon cas",
      consentRequired: "Vous devez accepter l'avis de confidentialité",
      submit: "Soumettre le Cas",
      submitting: "Soumission...",
      success: "Cas Soumis avec Succès",
      caseNumber: "Votre numéro de cas est",
      trackCase: "Suivre Votre Cas",
      error: "Échec de la soumission du cas",
      fileUpload: "Télécharger des Fichiers",
      fileUploadDescription: "Télécharger des documents justificatifs (PDF, PNG, JPG, CSV, max 10MB chacun)",
      privacyNotice: "Avis de Confidentialité",
      trackTitle: "Suivre Votre Cas",
      trackDescription: "Entrez votre numéro de cas et votre email pour voir le statut et les mises à jour de votre cas.",
      caseNumberLabel: "Numéro de Cas",
      emailLabel: "Adresse Email",
      lookup: "Suivre le Cas",
      verifying: "Vérification...",
      verificationCode: "Code de Vérification",
      verificationSent: "Nous avons envoyé un code de vérification à votre email. Veuillez l'entrer ci-dessous.",
      verify: "Vérifier",
      back: "Retour",
      caseDetails: "Détails du Cas",
      overview: "Vue d'ensemble",
      resolution: "Plan de Résolution",
      evidence: "Preuve",
      timeline: "Chronologie",
      status: "Statut",
      severity: "Sévérité",
      lastUpdated: "Dernière Mise à Jour",
      created: "Créé",
      resolutionPlan: "Votre Plan de Résolution",
      safetySteps: "Étapes de Sécurité",
      viewArtifact: "Voir l'Artefact de Résolution",
      noResolution: "Le plan de résolution est en cours de préparation. Revenez bientôt.",
      noEvidence: "Aucun fichier de preuve joint à ce cas.",
      noTimeline: "La vue chronologique sera disponible bientôt.",
      trackAnother: "Suivre un Autre Cas",
      dispute: "Litige de Paiement / Contrefacturation",
      fraud: "Fraude / Prise de Compte",
      outage: "Retard de Transaction / Panne",
      complaint: "Plainte / Autre",
    },
  },
  de: {
    common: {
      save: "Speichern",
      cancel: "Abbrechen",
      delete: "Löschen",
      edit: "Bearbeiten",
      create: "Erstellen",
      search: "Suchen",
      loading: "Laden...",
      error: "Fehler",
      success: "Erfolg",
    },
    nav: {
      overview: "Übersicht",
      signals: "Signale",
      claims: "Behauptungen",
      graph: "Glaubensgraph",
      forecasts: "Prognosen",
      studio: "AAAL Studio",
      governance: "Governance",
    },
    claims: {
      title: "Behauptungen",
      create: "Behauptung Erstellen",
      decisiveness: "Entschlossenheit",
      evidence: "Beweis",
      cluster: "Cluster",
    },
    evidence: {
      title: "Beweis",
      type: "Typ",
      source: "Quelle",
      content: "Inhalt",
    },
    cases: {
      title: "Problem Melden",
      description: "Reichen Sie einen Fall zur Bearbeitung ein. Unser autonomes System wird Ihren Fall klassifizieren und entsprechend weiterleiten.",
      type: "Problemtyp",
      typeRequired: "Problemtyp ist erforderlich",
      descriptionLabel: "Beschreibung",
      descriptionRequired: "Beschreibung ist erforderlich",
      descriptionMinLength: "Beschreibung muss mindestens 10 Zeichen lang sein",
      impact: "Auswirkung",
      preferredResolution: "Bevorzugte Lösung",
      submittedBy: "Ihre E-Mail oder Name",
      submittedByRequired: "Ihre E-Mail oder Name ist erforderlich",
      submittedByEmail: "E-Mail-Adresse",
      submittedByName: "Vollständiger Name",
      consent: "Ich stimme der Datenschutzerklärung zu und stimme der Bearbeitung meines Falls zu",
      consentRequired: "Sie müssen der Datenschutzerklärung zustimmen",
      submit: "Fall Einreichen",
      submitting: "Wird eingereicht...",
      success: "Fall Erfolgreich Eingereicht",
      caseNumber: "Ihre Fallnummer ist",
      trackCase: "Ihren Fall Verfolgen",
      error: "Fehler beim Einreichen des Falls",
      fileUpload: "Dateien Hochladen",
      fileUploadDescription: "Unterstützende Dokumente hochladen (PDF, PNG, JPG, CSV, max. 10MB pro Datei)",
      privacyNotice: "Datenschutzerklärung",
      trackTitle: "Ihren Fall Verfolgen",
      trackDescription: "Geben Sie Ihre Fallnummer und E-Mail ein, um den Status und Updates Ihres Falls anzuzeigen.",
      caseNumberLabel: "Fallnummer",
      emailLabel: "E-Mail-Adresse",
      lookup: "Fall Verfolgen",
      verifying: "Wird überprüft...",
      verificationCode: "Bestätigungscode",
      verificationSent: "Wir haben einen Bestätigungscode an Ihre E-Mail gesendet. Bitte geben Sie ihn unten ein.",
      verify: "Überprüfen",
      back: "Zurück",
      caseDetails: "Falldetails",
      overview: "Übersicht",
      resolution: "Lösungsplan",
      evidence: "Beweis",
      timeline: "Zeitachse",
      status: "Status",
      severity: "Schweregrad",
      lastUpdated: "Zuletzt Aktualisiert",
      created: "Erstellt",
      resolutionPlan: "Ihr Lösungsplan",
      safetySteps: "Sicherheitsschritte",
      viewArtifact: "Lösungsartefakt Anzeigen",
      noResolution: "Der Lösungsplan wird vorbereitet. Bitte schauen Sie später noch einmal vorbei.",
      noEvidence: "Keine Beweisdateien an diesen Fall angehängt.",
      noTimeline: "Zeitachsenansicht wird bald verfügbar sein.",
      trackAnother: "Weiteren Fall Verfolgen",
      dispute: "Zahlungsstreit / Rückbuchung",
      fraud: "Betrug / Kontoübernahme",
      outage: "Transaktionsverzögerung / Ausfall",
      complaint: "Beschwerde / Sonstiges",
    },
  },
  ja: {
    common: {
      save: "保存",
      cancel: "キャンセル",
      delete: "削除",
      edit: "編集",
      create: "作成",
      search: "検索",
      loading: "読み込み中...",
      error: "エラー",
      success: "成功",
    },
    nav: {
      overview: "概要",
      signals: "シグナル",
      claims: "主張",
      graph: "信念グラフ",
      forecasts: "予測",
      studio: "AAALスタジオ",
      governance: "ガバナンス",
    },
    claims: {
      title: "主張",
      create: "主張を作成",
      decisiveness: "決断力",
      evidence: "証拠",
      cluster: "クラスター",
    },
    evidence: {
      title: "証拠",
      type: "タイプ",
      source: "ソース",
      content: "コンテンツ",
    },
    cases: {
      title: "問題を報告",
      description: "解決のためにケースを提出してください。自律システムがケースを分類し、適切にルーティングします。",
      type: "問題の種類",
      typeRequired: "問題の種類は必須です",
      descriptionLabel: "説明",
      descriptionRequired: "説明は必須です",
      descriptionMinLength: "説明は少なくとも10文字である必要があります",
      impact: "影響",
      preferredResolution: "希望する解決策",
      submittedBy: "メールアドレスまたはお名前",
      submittedByRequired: "メールアドレスまたはお名前は必須です",
      submittedByEmail: "メールアドレス",
      submittedByName: "フルネーム",
      consent: "プライバシー通知に同意し、ケースの処理に同意します",
      consentRequired: "プライバシー通知に同意する必要があります",
      submit: "ケースを提出",
      submitting: "提出中...",
      success: "ケースが正常に提出されました",
      caseNumber: "ケース番号は",
      trackCase: "ケースを追跡",
      error: "ケースの提出に失敗しました",
      fileUpload: "ファイルをアップロード",
      fileUploadDescription: "サポート文書をアップロード（PDF、PNG、JPG、CSV、各最大10MB）",
      privacyNotice: "プライバシー通知",
      trackTitle: "ケースを追跡",
      trackDescription: "ケース番号とメールアドレスを入力して、ケースのステータスと更新を表示します。",
      caseNumberLabel: "ケース番号",
      emailLabel: "メールアドレス",
      lookup: "ケースを追跡",
      verifying: "確認中...",
      verificationCode: "確認コード",
      verificationSent: "確認コードをメールに送信しました。以下に入力してください。",
      verify: "確認",
      back: "戻る",
      caseDetails: "ケース詳細",
      overview: "概要",
      resolution: "解決計画",
      evidence: "証拠",
      timeline: "タイムライン",
      status: "ステータス",
      severity: "重大度",
      lastUpdated: "最終更新",
      created: "作成日",
      resolutionPlan: "解決計画",
      safetySteps: "安全対策",
      viewArtifact: "解決成果物を表示",
      noResolution: "解決計画を準備中です。後でもう一度確認してください。",
      noEvidence: "このケースに添付された証拠ファイルはありません。",
      noTimeline: "タイムラインビューは間もなく利用可能になります。",
      trackAnother: "別のケースを追跡",
      dispute: "支払い紛争 / チャージバック",
      fraud: "詐欺 / アカウント乗っ取り",
      outage: "取引遅延 / 障害",
      complaint: "苦情 / その他",
    },
  },
  zh: {
    common: {
      save: "保存",
      cancel: "取消",
      delete: "删除",
      edit: "编辑",
      create: "创建",
      search: "搜索",
      loading: "加载中...",
      error: "错误",
      success: "成功",
    },
    nav: {
      overview: "概览",
      signals: "信号",
      claims: "声明",
      graph: "信念图",
      forecasts: "预测",
      studio: "AAAL工作室",
      governance: "治理",
    },
    claims: {
      title: "声明",
      create: "创建声明",
      decisiveness: "决断力",
      evidence: "证据",
      cluster: "集群",
    },
    evidence: {
      title: "证据",
      type: "类型",
      source: "来源",
      content: "内容",
    },
    cases: {
      title: "报告问题",
      description: "提交案例以解决。我们的自主系统将适当地分类和路由您的案例。",
      type: "问题类型",
      typeRequired: "问题类型是必需的",
      descriptionLabel: "描述",
      descriptionRequired: "描述是必需的",
      descriptionMinLength: "描述必须至少10个字符",
      impact: "影响",
      preferredResolution: "首选解决方案",
      submittedBy: "您的电子邮件或姓名",
      submittedByRequired: "您的电子邮件或姓名是必需的",
      submittedByEmail: "电子邮件地址",
      submittedByName: "全名",
      consent: "我同意隐私通知并同意处理我的案例",
      consentRequired: "您必须接受隐私通知",
      submit: "提交案例",
      submitting: "提交中...",
      success: "案例提交成功",
      caseNumber: "您的案例编号是",
      trackCase: "跟踪您的案例",
      error: "提交案例失败",
      fileUpload: "上传文件",
      fileUploadDescription: "上传支持文档（PDF、PNG、JPG、CSV，每个最大10MB）",
      privacyNotice: "隐私通知",
      trackTitle: "跟踪您的案例",
      trackDescription: "输入您的案例编号和电子邮件以查看案例状态和更新。",
      caseNumberLabel: "案例编号",
      emailLabel: "电子邮件地址",
      lookup: "跟踪案例",
      verifying: "验证中...",
      verificationCode: "验证码",
      verificationSent: "我们已向您的电子邮件发送了验证码。请在下面输入。",
      verify: "验证",
      back: "返回",
      caseDetails: "案例详情",
      overview: "概览",
      resolution: "解决方案",
      evidence: "证据",
      timeline: "时间线",
      status: "状态",
      severity: "严重程度",
      lastUpdated: "最后更新",
      created: "创建时间",
      resolutionPlan: "您的解决方案",
      safetySteps: "安全步骤",
      viewArtifact: "查看解决方案工件",
      noResolution: "解决方案正在准备中。请稍后再查看。",
      noEvidence: "此案例没有附加证据文件。",
      noTimeline: "时间线视图即将推出。",
      trackAnother: "跟踪另一个案例",
      dispute: "支付争议 / 退单",
      fraud: "欺诈 / 账户接管",
      outage: "交易延迟 / 中断",
      complaint: "投诉 / 其他",
    },
  },
};

/**
 * Get translation for key
 */
export function t(key: string, locale: Locale = defaultLocale): string {
  const keys = key.split(".");
  let value: any = translations[locale];

  for (const k of keys) {
    if (value && typeof value === "object" && k in value) {
      value = value[k];
    } else {
      // Fallback to English
      value = translations[defaultLocale];
      for (const k2 of keys) {
        if (value && typeof value === "object" && k2 in value) {
          value = value[k2];
        } else {
          return key; // Return key if translation not found
        }
      }
      break;
    }
  }

  return typeof value === "string" ? value : key;
}

/**
 * Detect locale from request
 */
export function detectLocale(request: Request): Locale {
  // Check Accept-Language header
  const acceptLanguage = request.headers.get("accept-language");
  if (acceptLanguage) {
    const languages = acceptLanguage
      .split(",")
      .map((lang) => lang.split(";")[0].trim().toLowerCase().substring(0, 2));
    for (const lang of languages) {
      if (supportedLocales.includes(lang as Locale)) {
        return lang as Locale;
      }
    }
  }

  // Check URL path
  const url = new URL(request.url);
  const pathLocale = url.pathname.split("/")[1];
  if (supportedLocales.includes(pathLocale as Locale)) {
    return pathLocale as Locale;
  }

  return defaultLocale;
}

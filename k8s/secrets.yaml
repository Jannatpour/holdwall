apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: holdwall-secretstore
  namespace: holdwall
spec:
  provider:
    aws:
      service: ParameterStore
      region: us-east-1
      auth:
        jwt:
          serviceAccountRef:
            name: holdwall-app
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: holdwall-secrets
  namespace: holdwall
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: holdwall-secretstore
    kind: SecretStore
  target:
    name: holdwall-secrets
    creationPolicy: Owner
    deletionPolicy: Retain
  data:
    - secretKey: DATABASE_URL
      remoteRef:
        key: /holdwall/prod/app/DATABASE_URL
    - secretKey: NEXTAUTH_SECRET
      remoteRef:
        key: /holdwall/prod/app/NEXTAUTH_SECRET
    - secretKey: NEXTAUTH_URL
      remoteRef:
        key: /holdwall/prod/app/NEXTAUTH_URL
    - secretKey: CSRF_SECRET
      remoteRef:
        key: /holdwall/prod/app/CSRF_SECRET
    - secretKey: EVIDENCE_SIGNING_SECRET
      remoteRef:
        key: /holdwall/prod/app/EVIDENCE_SIGNING_SECRET
    - secretKey: EVIDENCE_SIGNER_ID
      remoteRef:
        key: /holdwall/prod/app/EVIDENCE_SIGNER_ID
    - secretKey: OPENAI_API_KEY
      remoteRef:
        key: /holdwall/prod/integrations/OPENAI_API_KEY
    - secretKey: ANTHROPIC_API_KEY
      remoteRef:
        key: /holdwall/prod/integrations/ANTHROPIC_API_KEY
    - secretKey: REDIS_URL
      remoteRef:
        key: /holdwall/prod/app/REDIS_URL
    - secretKey: KAFKA_BROKERS
      remoteRef:
        key: /holdwall/prod/workers/KAFKA_BROKERS
    - secretKey: KAFKA_ENABLED
      remoteRef:
        key: /holdwall/prod/workers/KAFKA_ENABLED
    - secretKey: KAFKA_EVENTS_TOPIC
      remoteRef:
        key: /holdwall/prod/workers/KAFKA_EVENTS_TOPIC
    - secretKey: KAFKA_GROUP_ID
      remoteRef:
        key: /holdwall/prod/workers/KAFKA_GROUP_ID
    - secretKey: KAFKA_DLQ_ENABLED
      remoteRef:
        key: /holdwall/prod/workers/KAFKA_DLQ_ENABLED
    - secretKey: KAFKA_DLQ_TOPIC
      remoteRef:
        key: /holdwall/prod/workers/KAFKA_DLQ_TOPIC
    - secretKey: KAFKA_SSL
      remoteRef:
        key: /holdwall/prod/workers/KAFKA_SSL
    - secretKey: BACKUP_ENCRYPTION_KEY
      remoteRef:
        key: /holdwall/prod/app/BACKUP_ENCRYPTION_KEY
    - secretKey: S3_BACKUP_BUCKET
      remoteRef:
        key: /holdwall/prod/app/S3_BACKUP_BUCKET
    - secretKey: CHROMA_URL
      remoteRef:
        key: /holdwall/prod/app/CHROMA_URL
    - secretKey: CHROMA_COLLECTION
      remoteRef:
        key: /holdwall/prod/app/CHROMA_COLLECTION
    - secretKey: CHROMA_API_KEY
      remoteRef:
        key: /holdwall/prod/app/CHROMA_API_KEY
    - secretKey: SENTRY_DSN
      remoteRef:
        key: /holdwall/prod/app/SENTRY_DSN
